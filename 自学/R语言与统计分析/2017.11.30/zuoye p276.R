x1<-c(70,60,70,40,40,70,70,80,60,30,80,40,60,40,20,50,50,40,80,70,60,90,50,70,20,80,60,50,70,40,30,30,40,60,80,70,30,60,80,70)
x2<-c(64,63,65,69,63,48,48,63,63,53,43,55,66,67,61,63,66,68,41,53,37,54,52,50,65,52,70,40,36,44,54,59,69,50,62,68,39,49,64,67)
x3<-c(5,9,11,10,58,9,11,4,14,4,12,2,25,23,19,4,16,12,12,8,13,12,8,7,21,28,13,13,22,36,9,87,5,22,4,15,4,11,10,18)
x4<-c(1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,0,0,0,0,0)
x5<-rep(c(1,0),c(21,19))
y<-c(1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,0,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1) 
a<-data.frame(x1,x2,x3,x4,y)
log.glm<-glm(y~.,family = binomial,data=a)
summary(log.glm)
#预测P(Y=1)概率
#尝试下计算第40号病人生存时间Y=1的概率：
b<-(-7.01140)+0.09994*70+0.01415*67+0.01749*18-1.08297*0-0.61309*0
exp(b)/(1+exp(b))    

pred.1<-predict(log.glm,a)  #注意到newdata=原数据集中去掉y对应的列
p1<-exp(pred.1)/(1+exp(pred.1));p1


###(2)
lm.step<-step(log.glm)
summary(lm.step)
pred.2<-predict(lm.step,a)  #注意到newdata=原数据集中去掉y对应的列
p2<-exp(pred.2)/(1+exp(pred.2));p2

cbind(p1,p2)

